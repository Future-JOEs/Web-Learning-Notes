# 采坑合集

## 没有全家桶脚手架

原生的React没有像vue和angular类似的全家桶脚手架，很多东西需要自己去配置，倒是啊里开发的DVA框架是有dva-cli的脚手架

react的cra（create-react-app）封装了webpack，如果需要重新配置webpack，要将相关的配置文件反编译出来

https://blog.csdn.net/xiaominghimi/article/details/90212826

## 文件后缀

主流的React项目中js文件的后缀似乎是.tsx，使用的是typescript的语法，通过官方脚手架`create-react-app`创建的项目中默认使用的是.js文件

### 在官方全家桶中使用typescript

> **为什么要使用typescrip**t
>
> 为了程序的健壮性，typescript的强类型可以防止在开发阶段出现的的各种类型的错误

官方全家桶中默认使用的js，甚至都不是jsx，那么为了使用typescript，首先就得安装typesript

```shell
npm i typescript --save-dev
```

官方全家桶中使用的与React相关的模块也需要安装typescript版本

React

```shell
npm i @types/react --save-dev
```
ReactDOM

```shell
npm i @types/react-dom --save-dev
```

安装完之后代码会提示报错，React模块没有默认导出，但是运行npm start之后就ok了，但是在默认的测试代码中有一个问题

![1565143569947](assets/1565143569947.png)

提示安装@types/jest，那咱就装吧

```shell
npm i @types/jest --save-dev
```

### 配置tslint

安装tslint

```shell
npm i tslint --save-dev
```

安装tslint-react

```shell
npm i tslint-react --save-dev
```

配置tsconfig.json

```json
{
  "compilerOptions": {
    "target": "es5",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "module": "esnext",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "preserve"
  },
  "include": [
    "src"
  ]
}

```

配置tslint.json

```json
{
  "extends": ["tslint:recommended", "tslint-react"],
  "rules": {
    "arrow-parens": false,
    "arrow-return-shorthand": [false],
    "comment-format": [true, "check-space"],
    "import-blacklist": [true, "rxjs"],
    "interface-over-type-literal": false,
    "interface-name": false,
    "max-line-length": false,
    "member-access": false,
    "member-ordering": [true, { "order": "fields-first" }],
    "newline-before-return": false,
    "no-empty": false,
    "no-any": false,
    "no-empty-interface": false,
    "no-import-side-effect": false,
    "no-namespace": false,
    "no-console": false,
    "no-inferrable-types": [true, "ignore-params", "ignore-properties"],
    "no-invalid-this": [true, "check-function-in-method"],
    "no-null-keyword": false,
    "no-require-imports": false,
    "no-submodule-imports": false,
    "no-this-assignment": [true, { "allow-destructuring": true }],
    "no-trailing-whitespace": true,
    "object-literal-sort-keys": false,
    "object-literal-shorthand": false,
    "one-variable-per-declaration": false,
    "only-arrow-functions": [true, "allow-declarations"],
    "ordered-imports": false,
    "prefer-method-signature": false,
    "prefer-template": [true, "allow-single-concat"],
    "quotemark": [true, "single", "jsx-double"],
    "semicolon": [true, "never", "ignore-interfaces"],
    "trailing-comma": [false],
    "triple-equals": [true, "allow-null-check"],
    "type-literal-delimiter": false,
    "typedef": [true, "property-declaration"],
    "variable-name": [true, "ban-keywords", "check-format", "allow-pascal-case", "allow-leading-underscore"],
    "max-classes-per-file": false,

    "jsx-no-lambda": false,
    "jsx-no-multiline-js": false,
    "jsx-curly-spacing": [true, { "when": "never", "allowMultiline": false }],
    "jsx-boolean-value": false
  }
}

```

可以在这个文件中修改相关规则，顺手就行

## 样式表的使用

据说在组件中通过import引入的样式没有模块作用域，是全局的，没有vue中类似scope的属性，这也就导致了样式表的模块化似乎也是需要自己去配置的，否则会导致不同组件的样式冲突。

### 配置其他类型的css处理文件

- scss

安装node-sass

```shell
npm i node-sass -D
```

### 行内样式的使用

React基本上抛弃了dom相关的操作，完全使用js，所以连css的行内样式都是一个对象

```jsx
var divStyle = {
  color: 'white',
  backgroundImage: 'url(' + imgUrl + ')',
  WebkitTransition: 'all', // 注意这里的首字母'W'是大写
  msTransition: 'all' // 'ms'是唯一一个首字母需要小写的浏览器前缀
};

export default Mycomponent(){
  render(){
    return (
      <div style={divStyle}></div>
    )
  }
}

// 以上是使用对象变量方式的引入，如果想简单引用
export default Mycomponent(){
  render(){
    return (
      <div style={{ marginTop: 10}}></div>
    )
  }
}
```

- 命名：小驼峰，基本告别`margin-top`这种形式
- 单位：如果是长度单位，默认不写表示`px`，**如果硬写`px`，反而会报错**，其他单位照常

## 配置react-router

[官方文档](https://reacttraining.com/react-router/web/guides/quick-start)

由于现在使用ts来开发，所以，recat-router的相关包也需要使用ts版本的

安装依赖

```shell
npm i @types/react-router-dom -D
```

只安装这个依赖，语法没有错误但是会编译报错，提示没有找到`react-router-dom`这个包，需要再次引入

非ts版的`react-router-dom`

```shell
npm i react-router-dom -D
```

## 没有双绑

没有双绑就会导致需要经常去对原生控件的一些事件进行重写，比如input标签的onChange事件，在这个事件中对绑定的state中的属性进行更新

